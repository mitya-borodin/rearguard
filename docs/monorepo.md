# rearguard monorepo

Инструмент для работы с [**"моно репозиторием"**](https://gitlab.com/mitya-borodin/base-code). Это такие репозитории которые включают несколько проектов.

Этот инструмент нужен для того, чтобы выполнять групповые действия над всеми пакетами внутри этого репозитория.

Так как пакеты имеют зависимости друг от друга, то выполнять действия нужно в сторогом порядке от независимых до имеющих наибольшее число зависимостей.

Для того, чтобы понять в каком порядке выполнять действия, необходимо зайти в каждый модуль и построить [**sync_project_deps**](https://gitlab.com/mitya-borodin/rearguard/blob/master/docs/sync_project_deps.md).
После чего можно выполнять действия над модулями в правильном порядке.

И так, у нас имеется список модулей по которому необходимо пройтись. Далее переходим к доступным действиям.

## Действия

### rearguard monorepo --init

- Создается конфигарационный фал monorepo.json, в котором указывается в какой директрии находятся модули.
- Создается файл .gitignore

### rearguard monorepo --install

- Проходит по модулям и запускает скрипт npm install, в синхронном режиме.

### rearguard monorepo --build

- Проходит по модулям и запускает скрипт npm run build, в синхронном режиме.

### rearguard monorepo --link

- Проходит по модулям и запускает скрипт npm link, в синхронном режиме.

### rearguard monorepo --bootstrap

- Проходит по модулям и запускает набор скриптов (clear, npm install, npm run build, npm run link), в синхронном режиме.

### rearguard monorepo --build --release | -r

- Проходит по модулям и запускает скрипт npm run build:both, в синхронном режиме.

### rearguard monorepo --test

- Проходит по модулям и запускает скрипт npm run test, в синхронном режиме.

### rearguard monorepo --publish [ --patch | --minor | --major ]

- Проходит по всем модулям, обновляет версию в зависимости от флага. По умолчанию флаг --patch. После чего выполняется npm publish.
